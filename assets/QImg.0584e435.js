import{ag as H,t as u,h as M,r as s,m as z,J as P,z as Q,D as o,ab as $,F,ah as U,x as J,ai as S,H as W}from"./index.d5f6795f.js";const y={left:!0,right:!0,up:!0,down:!0,horizontal:!0,vertical:!0},X=Object.keys(y);y.all=!0;function Z(e){const t={};for(const n of X)e[n]===!0&&(t[n]=!0);return Object.keys(t).length===0?y:(t.horizontal===!0?t.left=t.right=!0:t.left===!0&&t.right===!0&&(t.horizontal=!0),t.vertical===!0?t.up=t.down=!0:t.up===!0&&t.down===!0&&(t.vertical=!0),t.horizontal===!0&&t.vertical===!0&&(t.all=!0),t)}const x=["INPUT","TEXTAREA"];function p(e,t){return t.event===void 0&&e.target!==void 0&&e.target.draggable!==!0&&typeof t.handler=="function"&&x.includes(e.target.nodeName.toUpperCase())===!1&&(e.qClonedBy===void 0||e.qClonedBy.indexOf(t.uid)===-1)}function ee(){if(window.getSelection!==void 0){const e=window.getSelection();e.empty!==void 0?e.empty():e.removeAllRanges!==void 0&&(e.removeAllRanges(),H.is.mobile!==!0&&e.addRange(document.createRange()))}else document.selection!==void 0&&document.selection.empty()}const G={ratio:[String,Number]};function K(e,t){return u(()=>{const n=Number(e.ratio||(t!==void 0?t.value:void 0));return isNaN(n)!==!0&&n>0?{paddingBottom:`${100/n}%`}:null})}const V=1.7778;var te=M({name:"QImg",props:{...G,src:String,srcset:String,sizes:String,alt:String,crossorigin:String,decoding:String,referrerpolicy:String,draggable:Boolean,loading:{type:String,default:"lazy"},loadingShowDelay:{type:[Number,String],default:0},fetchpriority:{type:String,default:"auto"},width:String,height:String,initialRatio:{type:[Number,String],default:V},placeholderSrc:String,errorSrc:String,fit:{type:String,default:"cover"},position:{type:String,default:"50% 50%"},imgClass:String,imgStyle:Object,noSpinner:Boolean,noNativeMenu:Boolean,noTransition:Boolean,spinnerColor:String,spinnerSize:String},emits:["load","error"],setup(e,{slots:t,emit:n}){const b=s(e.initialRatio),w=K(e,b),f=W(),{registerTimeout:C,removeTimeout:m}=z(),{registerTimeout:N,removeTimeout:_}=z(),v=u(()=>e.placeholderSrc!==void 0?{src:e.placeholderSrc}:null),R=u(()=>e.errorSrc!==void 0?{src:e.errorSrc,__qerror:!0}:null),r=[s(null),s(v.value)],a=s(0),c=s(!1),d=s(!1),L=u(()=>`q-img q-img--${e.noNativeMenu===!0?"no-":""}menu`),k=u(()=>({width:e.width,height:e.height})),I=u(()=>`q-img__image ${e.imgClass!==void 0?e.imgClass+" ":""}q-img__image--with${e.noTransition===!0?"out":""}-transition q-img__image--`),B=u(()=>({...e.imgStyle,objectFit:e.fit,objectPosition:e.position}));function j(){if(_(),e.loadingShowDelay===0){c.value=!0;return}N(()=>{c.value=!0},e.loadingShowDelay)}function h(){_(),c.value=!1}function A({target:i}){S(f)===!1&&(m(),b.value=i.naturalHeight===0?.5:i.naturalWidth/i.naturalHeight,T(i,1))}function T(i,l){l===1e3||S(f)===!0||(i.complete===!0?D(i):C(()=>{T(i,l+1)},50))}function D(i){S(f)!==!0&&(a.value=a.value^1,r[a.value].value=null,h(),i.getAttribute("__qerror")!=="true"&&(d.value=!1),n("load",i.currentSrc||i.src))}function O(i){m(),h(),d.value=!0,r[a.value].value=R.value,r[a.value^1].value=v.value,n("error",i)}function q(i){const l=r[i].value,g={key:"img_"+i,class:I.value,style:B.value,alt:e.alt,crossorigin:e.crossorigin,decoding:e.decoding,referrerpolicy:e.referrerpolicy,height:e.height,width:e.width,loading:e.loading,fetchpriority:e.fetchpriority,"aria-hidden":"true",draggable:e.draggable,...l};return a.value===i?Object.assign(g,{class:g.class+"current",onLoad:A,onError:O}):g.class+="loaded",o("div",{class:"q-img__container absolute-full",key:"img"+i},o("img",g))}function E(){return c.value===!1?o("div",{key:"content",class:"q-img__content absolute-full q-anchor--skip"},F(t[d.value===!0?"error":"default"])):o("div",{key:"loading",class:"q-img__loading absolute-full flex flex-center"},t.loading!==void 0?t.loading():e.noSpinner===!0?void 0:[o(U,{color:e.spinnerColor,size:e.spinnerSize})])}{let i=function(){J(()=>e.src||e.srcset||e.sizes?{src:e.src,srcset:e.srcset,sizes:e.sizes}:null,l=>{m(),d.value=!1,l===null?(h(),r[a.value^1].value=v.value):j(),r[a.value].value=l},{immediate:!0})};P.value===!0?Q(i):i()}return()=>{const i=[];return w.value!==null&&i.push(o("div",{key:"filler",style:w.value})),r[0].value!==null&&i.push(q(0)),r[1].value!==null&&i.push(q(1)),i.push(o($,{name:"q-transition--fade"},E)),o("div",{key:"main",class:L.value,style:k.value,role:"img","aria-label":e.alt},i)}}});export{te as Q,ee as c,Z as g,p as s};
